#!/bin/sh

FILE="~/.local/share/larbs/urlquery"

OBJ_SELECTED=$(jq -r ".[][0]" "$FILE" | dmenu -l 10 -p "Select a website")

if [ -z "$OBJ_SELECTED" ]; then
    exit 1
fi

URLQUERY=$(jq -r --arg sel "$OBJ_SELECTED" 'map(select(.[0] == $sel))[0][1]' "$FILE")

if echo "$URLQUERY" | grep -q "search"; then
    OBJ_KEYWORDS=$(dmenu -l 0 -p "Enter keywords" | tr " " "+")
    firefox "${URLQUERY}${OBJ_KEYWORDS}"
else
    firefox "${URLQUERY}"
fi
